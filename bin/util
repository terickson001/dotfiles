#! /usr/bin/env bash

update() {
    cd $HOME/.utils/
    while read -r line; do
        [[ $line = "" ]] && continue
        if [[ $line =~ \[.*\] ]]; then
            mode=$(sed "s/\[\(.*\)\]/\1/" <<< $line)
            continue
        fi
        src=$line
        
        echo "Updating '$src'..."
        if [[ $mode = "github" ]]; then
            dir=$(sed "s/.*\/\([^\.]*\)\(\.git\)*$/\1/" <<< $src)
            if [[ -d $dir ]]; then
                cd $dir
                git fetch origin
                git reset --hard origin/master
                cd ..
            else
                git clone https://github.com/$src
            fi
        elif [[ $mode = "git" ]]; then
            dir=$(sed "s/.*\/\([^\.]*\)\(\.git\)*$/\1/" <<< $src)
            if [[ -d $dir ]]; then
                cd $dir
                git fetch origin
                git reset --hard origin/master
                cd ..
            else
                git clone $src
            fi
        else
            echo "Sources for '$mode' are not yet implemented"
            continue
        fi

        echo
    done < "./SOURCES"
    echo "Done."
}

get_dict() {
    dest=${1:-dict}
    ln -s $HOME/.utils/english-words/words.txt $dest
}

get_gb() {
    dest=${1:-gb}
    ln -s $HOME/.utils/gb $dest
}

op=$1; shift

$op ${args[@]}
